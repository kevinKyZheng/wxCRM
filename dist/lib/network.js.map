{"version":3,"sources":["lib/network.js"],"names":["app","getApp","requestWithLoading","url","params","message","success","fail","timestamp","Date","parse","date","Y","getFullYear","M","getMonth","D","getDate","H","getHours","Mi","getMinutes","S","getSeconds","nowTime","timeStrMD5","toUpperCase","substring","token","globalData","userInfo","seconds","getTime","timeInterval","Math","floor","toString","wx","showLoading","title","request","data","header","method","res","hideLoading","e","module","exports"],"mappings":";;AACA;;;;AACA;;;;AACA,IAAMA,MAAMC,QAAZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,kBAAT,CAA4BC,GAA5B,EAAgCC,MAAhC,EAAkE;AAAA,QAA3BC,OAA2B,uEAAnB,KAAmB;AAAA,QAAbC,QAAa;AAAA,QAALC,KAAK;;AAC9D,QAAIC,YAAYC,KAAKC,KAAL,CAAW,IAAID,IAAJ,EAAX,CAAhB;AACA,QAAIE,OAAO,IAAIF,IAAJ,CAASD,SAAT,CAAX;AACA,QAAII,IAAGD,KAAKE,WAAL,EAAP;AACA,QAAIC,IAAKH,KAAKI,QAAL,KAAkB,CAAlB,GAAsB,EAAtB,GAA2B,OAAOJ,KAAKI,QAAL,KAAkB,CAAzB,CAA3B,GAAyDJ,KAAKI,QAAL,KAAkB,CAApF,CAJ8D,CAI6B;AAC3F,QAAIC,IAAIL,KAAKM,OAAL,KAAiB,EAAjB,GAAsB,MAAMN,KAAKM,OAAL,EAA5B,GAA6CN,KAAKM,OAAL,EAArD;AACA,QAAIC,IAAIP,KAAKQ,QAAL,KAAkB,EAAlB,GAAuB,MAAMR,KAAKQ,QAAL,EAA7B,GAA+CR,KAAKQ,QAAL,EAAvD;AACA,QAAIC,KAAKT,KAAKU,UAAL,KAAoB,EAApB,GAAyB,MAAMV,KAAKU,UAAL,EAA/B,GAAmDV,KAAKU,UAAL,EAA5D;AACA,QAAIC,IAAIX,KAAKY,UAAL,KAAoB,EAApB,GAAyB,MAAMZ,KAAKY,UAAL,EAA/B,GAAmDZ,KAAKY,UAAL,EAA3D;AACA,QAAIC,UAAUZ,IAAIE,CAAJ,GAAQE,CAAR,GAAYE,CAAZ,GAAgBE,EAAhB,GAAqBE,CAAnC;AACA,QAAIG,aAAa,mBAAOD,OAAP,EAAgBE,WAAhB,GAA8BC,SAA9B,CAAwC,CAAxC,EAA0C,EAA1C,CAAjB;AACA,QAAIC,QAAQ,mBAAO5B,IAAI6B,UAAJ,CAAeC,QAAf,CAAwB,OAAxB,IAAkCL,UAAzC,EAAqDC,WAArD,EAAZ;AACA;AACA,QAAIK,UAAUpB,KAAKqB,OAAL,KAAe,IAA7B,CAb8D,CAa5B;AAClC,QAAIC,eAAcC,KAAKC,KAAL,CAAWJ,OAAX,EAAoBK,QAApB,EAAlB;AACA,QAAI/B,WAAW,EAAf,EAAkB;AACdgC,WAAGC,WAAH,CAAe;AACXC,mBAAMlC;AADK,SAAf;AAGH;AACDgC,OAAGG,OAAH,CAAW;AACPrC,aAAIA,GADG;AAEPsC,cAAKrC,MAFE;AAGP;AACAsC,gBAAQ;AACJ,4BAAgB,kBADZ,EACgC;AACpC,sBAAS1C,IAAI6B,UAAJ,CAAeC,QAAf,CAAwB,QAAxB,CAFL;AAGJ,qBAAQF,KAHJ;AAIJ,uBAAUK,YAJN;AAKJ,sBAAS;AALL,SAJD;AAWPU,gBAAO,MAXA;AAYPrC,iBAAQ,iBAASsC,GAAT,EAAa;AACjBP,eAAGQ,WAAH;AACAvC,qBAAQsC,IAAIH,IAAZ;AACH,SAfM;AAgBPlC,cAAK,cAASuC,CAAT,EAAW;AACZT,eAAGQ,WAAH;AACAtC;AACH;AAnBM,KAAX;AAqBH;AACD,SAASiC,OAAT,CAAiBrC,GAAjB,EAAqBC,MAArB,EAA4BE,OAA5B,EAAoCC,IAApC,EAAyC;AACrC,SAAKL,kBAAL,CAAwBC,GAAxB,EAA4BC,MAA5B,EAAmC,EAAnC,EAAsCE,OAAtC,EAA8CC,IAA9C;AACH;AACDwC,OAAOC,OAAP,GAAiB;AACb9C,wBAAoBA,kBADP;AAEbsC,aAASA;AAFI,CAAjB","file":"network.js","sourcesContent":["\nimport time from \"../utils/util.js\";\nimport { hexMD5 } from '../utils/util';\nconst app = getApp()\n// function header(){\n//     //计算 token\n//     var timestamp = Date.parse(new Date());   \n//     var date = new Date(timestamp);         \n//     var Y =date.getFullYear();     \n//     var M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1);    //日      \n//     var D = date.getDate() < 10 ? '0' + date.getDate() : date.getDate();\n//     var H = date.getHours() < 10 ? '0' + date.getHours() : date.getHours();   \n//     var Mi = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();\n//     var S = date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds();\n//     var nowTime = Y + M + D + H + Mi + S;\n//     var timeStrMD5 = hexMD5(nowTime).toUpperCase().substring(8,24);\n//     var token = hexMD5(app.globalData.userInfo[\"token\"]+ timeStrMD5).toUpperCase()\n//     //计算 时间戳\n//     var seconds = date.getTime()/1000 //注意getTime()取得是毫秒数\n//     var timeInterval= Math.floor(seconds).toString();\n//     return {\n//         'content-type': 'application/json', // 默认值\n//         'userid':app.globalData.userInfo[\"userId\"],\n//         'token':token,\n//         'nowTime':timeInterval,\n//         'source':'iOS'\n//     }\n// }\n// const default_header = this.header()\n// header = default_header\nfunction requestWithLoading(url,params,message=\"加载中\",success,fail){\n    var timestamp = Date.parse(new Date());   \n    var date = new Date(timestamp);         \n    var Y =date.getFullYear();     \n    var M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1);    //日      \n    var D = date.getDate() < 10 ? '0' + date.getDate() : date.getDate();\n    var H = date.getHours() < 10 ? '0' + date.getHours() : date.getHours();   \n    var Mi = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();\n    var S = date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds();\n    var nowTime = Y + M + D + H + Mi + S;\n    var timeStrMD5 = hexMD5(nowTime).toUpperCase().substring(8,24);\n    var token = hexMD5(app.globalData.userInfo[\"token\"]+ timeStrMD5).toUpperCase()\n    //计算 时间戳\n    var seconds = date.getTime()/1000 //注意getTime()取得是毫秒数\n    var timeInterval= Math.floor(seconds).toString();\n    if (message != \"\"){\n        wx.showLoading({\n            title:message\n        })\n    }\n    wx.request({\n        url:url,\n        data:params,\n        // header:header,\n        header: {\n            'content-type': 'application/json', // 默认值\n            'userid':app.globalData.userInfo[\"userId\"],\n            'token':token,\n            'nowTime':timeInterval,\n            'source':'iOS'\n            },\n        method:\"POST\",\n        success:function(res){\n            wx.hideLoading()\n            success(res.data)\n        },\n        fail:function(e){\n            wx.hideLoading()\n            fail()\n        }\n    })\n}\nfunction request(url,params,success,fail){\n    this.requestWithLoading(url,params,\"\",success,fail)\n}\nmodule.exports = {\n    requestWithLoading: requestWithLoading,\n    request: request\n}"]}